<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klara AI - Din Intelligenta Cateringkoordinator</title>
    
    <meta name="description" content="Planera ditt evenemang enkelt med Klara, en AI-driven cateringkoordinator från NordSym. Få hjälp med bokningar, menyer och detaljer direkt i chatten.">
    <meta name="author" content="NordSym AB">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="icon" href="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg">
    
    <style>
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            color: #E2E8F0;
            background-color: #0c1427;
            background-image: radial-gradient(circle at 10% 10%, rgba(30, 58, 138, 0.3) 0%, transparent S30%),
                              radial-gradient(circle at 90% 80%, rgba(0, 212, 255, 0.1) 0%, transparent 40%);
        }
        :root {
            --nord-sym-cyan: #00D4FF;
            --nord-sym-deep-space-blue: #0c1427; 
            --nord-sym-mid-space-blue: #1e3a8a; 
            --nord-sym-light-accent: #7dd3fc; 
            --nord-sym-text-light: #F0F4F8; 
            --nord-sym-text-medium: #CBD5E0; 
            --nord-sym-cyan-rgb: 0, 212, 255;
            --nord-sym-deep-space-blue-rgb: 12, 20, 39;
            --nord-sym-mid-space-blue-rgb: 30, 58, 138;
        }
        h1, h2, h3 { font-family: 'Comfortaa', sans-serif; }

        /* --- Återanvända Komponenter --- */
        .btn-base {
            font-weight: 600; border-radius: 9999px; transition: all 0.3s ease;
            box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.25), 0px 2px 4px rgba(0,0,0,0.2), 
                        inset 0px -2px 1px rgba(255,255,255,0.05), inset 0px 1px 1px rgba(0,0,0,0.1); 
            display: inline-flex; align-items: center; justify-content: center;
            gap: 0.5rem; text-align: center;
        }
        .btn-cta-revised {
            padding: 0.85rem 2.25rem;
            background: transparent;
            border: 2px solid var(--nord-sym-cyan);
            color: var(--nord-sym-cyan);
            font-weight: 700;
        }
        .btn-cta-revised:hover {
            background: rgba(var(--nord-sym-cyan-rgb), 1);
            box-shadow: 0 0 25px rgba(var(--nord-sym-cyan-rgb), 0.7);
            transform: translateY(-3px) scale(1.03);
            color: var(--nord-sym-deep-space-blue);
        }
        .form-input {
            width: 100%;
            background-color: rgba(var(--nord-sym-deep-space-blue-rgb), 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem; padding: 0.85rem 1rem; color: var(--nord-sym-text-light);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .form-input:focus {
            outline: none; border-color: var(--nord-sym-cyan); box-shadow: 0 0 15px rgba(var(--nord-sym-cyan-rgb), 0.3);
        }
        .footer-link { color: var(--nord-sym-text-medium); transition: color 0.3s ease; }
        .footer-link:hover { color: var(--nord-sym-cyan); }
        .header-link { font-size: 0.9rem; font-weight: 500; color: var(--nord-sym-text-medium); transition: color 0.3s ease; position: relative; padding: 0.25rem 0; }
        .header-link::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background-color: var(--nord-sym-cyan); transition: width 0.3s ease; }
        .header-link:hover { color: var(--nord-sym-text-light); }
        .header-link:hover::after { width: 100%; }

        /* --- Specifika Stilar för Landningssida --- */
        .phone-mockup {
            background: #1a1c2a; border: 8px solid #111; border-radius: 40px;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5), inset 0 0 0 2px rgba(255,255,255,0.1);
            overflow: hidden; position: relative; aspect-ratio: 9 / 19.5; width: 100%;
            max-width: 320px;
            margin: auto;
        }
        .phone-screen {
            background: #0c1427; width: 100%; height: 100%; padding: 10px;
            display: flex; flex-direction: column;
        }
        .phone-notch {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 40%; height: 20px; background: #111; border-radius: 0 0 10px 10px; z-index: 2;
        }
        .app-nav {
            display: flex; justify-content: center; align-items: center;
            width: 100%; max-width: 250px; margin-top: auto;
        }
        .app-nav-slider-track {
            width: 100%; height: 44px;
            background: rgba(0,0,0,0.2);
            border-radius: 99px;
            position: relative;
            display: flex; align-items: center;
        }
        .app-nav-slider-icons {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex; justify-content: space-around;
            align-items: center;
            color: rgba(255,255,255,0.4);
            font-size: 1.5rem;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .app-nav-slider-thumb {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 40px; height: 40px;
            background: var(--nord-sym-cyan);
            border-radius: 50%;
            cursor: grab;
            touch-action: none; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            display: flex; align-items: center; justify-content: center;
        }
        .app-nav-slider-thumb.grabbing { cursor: grabbing; }
        .app-nav-slider-thumb i {
            font-size: 1.5rem;
            color: var(--nord-sym-deep-space-blue);
            transition: transform 0.2s ease;
        }
        .upload-placeholder {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            width: 100%; height: 100%; border: 2px dashed rgba(255,255,255,0.2); border-radius: 1rem;
            color: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.2s ease;
        }
        .upload-placeholder:hover {
            background-color: rgba(255,255,255,0.05); color: rgba(255,255,255,0.7);
            border-color: rgba(var(--nord-sym-cyan-rgb), 0.5);
        }
        .animate-float { animation: float 6s ease-in-out infinite; }
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
            100% { transform: translateY(0); }
        }
        .app-chat-container {
            display: flex; flex-direction: column; height: 100%; width: 100%;
            margin: -0.75rem;
        }
        #app-chat-messages {
            flex-grow: 1; overflow-y: auto; padding: 0.75rem;
            display: flex; flex-direction: column; gap: 0.75rem;
            scrollbar-width: none;
        }
        #app-chat-messages.is-idle {
            align-items: center; justify-content: center; text-align: center;
        }
        #app-chat-messages::-webkit-scrollbar { display: none; }
        .app-chat-message {
            display: flex; align-items: flex-start; gap: 0.5rem; max-width: 85%;
        }
        .app-chat-avatar {
            width: 28px; height: 28px; flex-shrink: 0;
        }
        .app-chat-bubble {
            padding: 0.5rem 0.85rem; border-radius: 1rem;
            font-size: 0.8rem; line-height: 1.4;
        }
        .app-message-klara { align-self: flex-start; }
        .app-message-klara .app-chat-bubble {
            background: var(--nord-sym-mid-space-blue);
            border-bottom-left-radius: 0.25rem; color: var(--nord-sym-text-light);
        }
        .app-message-user { align-self: flex-end; }
        .app-message-user .app-chat-bubble {
            background: var(--nord-sym-cyan); color: var(--nord-sym-deep-space-blue);
            font-weight: 500; border-bottom-right-radius: 0.25rem;
        }
        #app-chat-form {
            display: flex; gap: 0.5rem; padding: 0.75rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1); flex-shrink: 0;
            height: 60px;
            align-items: center;
        }
        #app-chat-input {
            flex-grow: 1; background-color: rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 99px;
            padding: 0.5rem 1rem; color: var(--nord-sym-text-light); font-size: 0.8rem;
        }
        #app-chat-input:focus { outline: none; border-color: var(--nord-sym-cyan); }
        #app-chat-form button {
            background: var(--nord-sym-cyan); color: var(--nord-sym-deep-space-blue);
            border: none; border-radius: 50%; width: 36px; height: 36px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0; cursor: pointer;
        }
        .agent-card {
            background: rgba(var(--nord-sym-mid-space-blue-rgb), 0.2);
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.2);
            border-radius: 0.75rem;
            padding: 1.25rem;
            text-align: left;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .agent-card:hover, .agent-card.selected {
            background: rgba(var(--nord-sym-mid-space-blue-rgb), 0.4);
            border-color: rgba(var(--nord-sym-cyan-rgb), 0.8);
            transform: translateY(-5px);
        }
        .agent-card.selected {
            box-shadow: 0 0 20px rgba(var(--nord-sym-cyan-rgb), 0.4);
        }
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            border: 1px solid rgb(51 65 85);
            border-radius: 1rem;
            overflow: hidden;
            background-color: #000;
        }
        .video-container video {
             position: absolute;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             object-fit: cover;
        }
        .dev-nav-btn {
            background-color: rgba(var(--nord-sym-cyan-rgb), 0.8);
            color: var(--nord-sym-deep-space-blue);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 0.8rem;
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 1);
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(5px);
        }
        .dev-nav-btn:hover {
            background-color: rgba(var(--nord-sym-cyan-rgb), 1);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(var(--nord-sym-cyan-rgb), 0.3);
        }
        
        /* --- Custom Calendar --- */
        #cal-days .cal-day {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            aspect-ratio: 1 / 1;
        }
        #cal-days .cal-day:not(.disabled):not(.empty):hover {
            background-color: rgba(var(--nord-sym-cyan-rgb), 0.2);
        }
        #cal-days .cal-day.today {
            border: 1px solid rgba(var(--nord-sym-cyan-rgb), 0.5);
        }
        #cal-days .cal-day.selected {
            background-color: var(--nord-sym-cyan);
            color: var(--nord-sym-deep-space-blue);
            font-weight: bold;
        }
        #cal-days .cal-day.disabled {
            color: rgba(var(--nord-sym-text-medium), 0.3);
            cursor: not-allowed;
        }
        #cal-days .cal-day.empty {
            cursor: default;
        }
    </style>
</head>
<body class="antialiased">

    <header class="w-full fixed top-0 left-0 z-50 bg-slate-900/50 backdrop-blur-md border-b border-slate-800/50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" id="logoLink" aria-label="Tillbaka till startsidan">
                <img src="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg" alt="NordSym Logotyp" class="h-12">
            </a>
            <a href="#" class="hidden md:inline-block btn-base btn-cta-revised" style="padding: 0.6rem 1.75rem; font-size: 0.9rem;">Boka Demo</a>
        </div>
    </header>

    <main class="flex-grow">
        <!-- ======================= STEG 1: INTRO & FÅNGA INTRESSE (Ny Layout) ======================= -->
        <section id="step-1">
            <div class="min-h-screen flex items-center py-20 lg:py-10 relative">
                <div class="container mx-auto px-6">
                    <div class="flex flex-col items-center space-y-16 md:space-y-24">

                        <!-- Top Row: Text and Phone -->
                        <div class="grid lg:grid-cols-2 gap-12 items-center w-full max-w-7xl mx-auto pt-32 lg:pt-24">
                            <!-- Left: Title, Text, Email Form -->
                            <div class="text-center lg:text-left">
                                <h1 class="text-4xl md:text-5xl lg:text-5xl font-bold leading-tight text-white max-w-xl mx-auto lg:mx-0">
                                    Revolutionera er <span style="color: var(--nord-sym-light-accent);">eventplanering</span>.
                                </h1>
                                <p class="mt-6 text-lg md:text-xl text-slate-300 max-w-2xl mx-auto lg:mx-0">
                                    Klara hanterar allt från menyer till logistik, så att ni kan fokusera helhjärtat på era gäster.
                                </p>
                                <div class="mt-6 border-l-2 border-sky-500/50 pl-4">
                                    <p class="text-slate-300 italic">Klara är två sidor av samma mynt. För era kunder – en vänlig guide som löser alla deras behov. För er – ett strategiskt verktyg som skalar er verksamhet och skapar utrymme för tillväxt.</p>
                                </div>
                                <div class="mt-10 max-w-lg mx-auto lg:mx-0">
                                     <div class="flex flex-col sm:flex-row gap-4">
                                        <input type="email" id="emailInput" name="email" class="form-input flex-grow" placeholder="din.email@foretag.se" required>
                                        <button type="button" id="nextStepButton" class="btn-base btn-cta-revised">Påbörja anpassning</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Right: Phone Mockup -->
                            <div class="w-full max-w-sm mx-auto">
                                <div class="phone-mockup">
                                    <div class="phone-notch"></div>
                                    <div class="phone-screen">
                                        <div class="flex-grow relative overflow-hidden rounded-3xl">
                                            <div id="screen-wrapper" class="flex h-full w-[300%] transition-transform duration-300 ease-out">
                                                <!-- Skärm 0: Chatt -->
                                                <div class="app-screen w-[33.33%]">
                                                    <div class="app-chat-container">
                                                        <div id="app-chat-messages" class="is-idle">
                                                            <div class="relative text-center p-4">
                                                                 <div id="klara-glow" class="absolute inset-0 m-auto w-40 h-40 blur-3xl rounded-full"></div>
                                                                 <img src="https://raw.githubusercontent.com/GusHem/GusHem-Ugglan-Klara/refs/heads/main/frilagd-bild.svg" alt="Klara" class="relative w-20 h-20 mx-auto mt-4 mb-4 animate-float">
                                                                 <p class="relative font-bold text-white text-base">Hej! Jag är Klara.</p>
                                                                 <p class="relative text-slate-300 text-xs mt-1">Fråga mig om att boka catering!</p>
                                                            </div>
                                                        </div>
                                                        <form id="app-chat-form">
                                                            <input type="text" id="app-chat-input" placeholder="Skriv ditt meddelande..." autocomplete="off">
                                                            <button type="submit"><i class="ph-paper-plane-tilt text-lg"></i></button>
                                                        </form>
                                                    </div>
                                                </div>
                                                <!-- Skärm 1: Dokument (Video) -->
                                                <div class="app-screen w-[33.33%]">
                                                    <video src="https://firebasestorage.googleapis.com/v0/b/nordsym-funnel.firebasestorage.app/o/Sk%C3%A4rminspelningar%20f%C3%B6r%20klara-appen%2FKlara%20app%20telefon.mov?alt=media&token=bea9cd09-04ff-4301-b0bf-54ea5202a81d" class="w-full h-full object-contain rounded-2xl" autoplay muted loop playsinline></video>
                                                </div>
                                                <!-- Skärm 2: Anpassad Klara -->
                                                <div class="app-screen w-[33.33%] flex flex-col items-center justify-center text-center p-2">
                                                     <img src="https://raw.githubusercontent.com/GusHem/GusHem-Ugglan-Klara/refs/heads/main/Klara%20Hardhatt.svg" alt="Anpassad Klara" class="relative w-20 h-20 mx-auto mb-4 animate-float">
                                                     <p class="font-bold text-white text-base">Skräddarsydd för er</p>
                                                     <p class="text-slate-300 text-xs mt-1 max-w-[200px] mx-auto">Klara kan anpassas med expertis för just eran verksamhet och integreras sömlöst med era befintliga affärssystem.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <nav class="app-nav mt-6">
                                    <div class="app-nav-slider-track" id="nav-track">
                                        <div class="app-nav-slider-icons" id="inactive-icons">
                                            <i class="ph-house"></i><i class="ph-file-text"></i><i class="ph-gear"></i>
                                        </div>
                                        <div class="app-nav-slider-thumb" id="nav-thumb">
                                            <i class="ph-house text-lg" id="thumb-icon"></i>
                                        </div>
                                    </div>
                                </nav>
                            </div>
                        </div>

                        <!-- Bottom Row: Video -->
                        <div class="w-full max-w-4xl mx-auto">
                            <h2 class="text-3xl font-bold text-white text-center">Känner du igen dig?</h2>
                            <p class="mt-4 text-lg text-slate-300 text-center">Lägg inte en hel helg på att jaga catering. Låt Klara göra jobbet på 30 sekunder.</p>
                            <div class="mt-8 video-container">
                                <video id="intro-video" src="https://firebasestorage.googleapis.com/v0/b/nordsym-funnel.firebasestorage.app/o/AI_Solution_Regret.mov?alt=media&token=a7ed42d2-3999-4062-bdee-5e5001524008" controls autoplay muted loop playsinline></video>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- ======================= STEG 2: VIDEO 1 & KVALIFICERA LEAD ======================= -->
        <section id="step-2" style="position: absolute; left: -9999px; width: 100%;">
             <div class="min-h-screen flex items-center py-20 lg:py-16">
                 <div class="container mx-auto px-6 w-full">
                     <div class="grid lg:grid-cols-2 gap-12 items-center">
                        <!-- Vänster kolumn: Video -->
                        <div class="text-center lg:text-left">
                            <h2 class="text-3xl md:text-4xl font-bold text-white">Mer än bara kod.</h2>
                            <p class="mt-4 text-lg text-slate-300 max-w-2xl mx-auto lg:mx-0">Det här är vår vision: Ett sömlöst samspel mellan innovation och svensk tradition. Ett intelligent ekosystem som arbetar tyst i bakgrunden för att lyfta det som gör just er verksamhet unik.</p>
                            <div class="mt-10 video-container">
                                <video id="video-1" src="https://firebasestorage.googleapis.com/v0/b/nordsym-funnel.firebasestorage.app/o/Cinematic_Trosa_Crystal_Cube_Sequence.mp4?alt=media&token=cff7392a-eba5-46ff-be0d-2d80c2538ad1" controls autoplay loop playsinline></video>
                            </div>
                        </div>
                        <!-- Höger kolumn: Formulär -->
                        <div class="w-full max-w-md mx-auto bg-slate-900/40 border border-slate-700 rounded-2xl p-8 backdrop-blur-sm shadow-2xl shadow-black/30">
                            <div class="text-center">
                                <img src="https://raw.githubusercontent.com/GusHem/GusHem-Ugglan-Klara/refs/heads/main/Klara%20Hardhatt.svg" alt="Klara med bygghjälm" class="h-20 mx-auto mb-4 animate-float">
                                <span class="text-sm font-semibold text-sky-400 tracking-wider">STEG 2 / 3</span>
                                <h3 class="text-2xl font-bold text-white mt-2">Anpassa Klara för er verksamhet</h3>
                                <p class="mt-2 text-slate-300">Nu börjar anpassningen. Din input används för att konfigurera en Klara som är skräddarsydd för just era processer. Beskriv er största utmaning, så visar vi hur applikationen kan lösa den.</p>
                            </div>
                            <form id="detailsForm" class="space-y-4 mt-8">
                                 <input type="hidden" id="detailsEmail" name="email">
                                 <input type="hidden" name="_subject" value="Utökad intresseanmälan för Klara AI!">
                                <div>
                                    <label for="name" class="block text-sm font-medium text-slate-300 mb-1 sr-only">Ditt namn</label>
                                    <input type="text" id="name" name="name" class="form-input" placeholder="Ditt namn" required>
                                </div>
                                <div>
                                    <label for="company" class="block text-sm font-medium text-slate-300 mb-1 sr-only">Företagsnamn</label>
                                    <input type="text" id="company" name="company" class="form-input" placeholder="Företagsnamn">
                                </div>
                                <div>
                                    <label for="goal" class="block text-sm font-medium text-slate-300 mb-1 sr-only">Vad vill du uppnå med Klara?</label>
                                    <textarea id="goal" name="goal" rows="4" class="form-input" placeholder="Beskriv den process ni helst skulle vilja slippa hantera manuellt."></textarea>
                                </div>
                                <div class="pt-2">
                                     <button type="submit" class="btn-base btn-cta-revised w-full">Slutför & välj min bonus-agent</button>
                                </div>
                            </form>
                        </div>
                     </div>
                 </div>
            </div>
        </section>

        <!-- ======================= STEG 3: VIDEO 2 & GIVEAWAY ======================= -->
        <section id="step-3" style="position: absolute; left: -9999px; width: 100%;">
             <div class="min-h-screen flex items-center justify-center py-20 lg:py-16">
                <div class="container mx-auto px-6 w-full">
                    <div class="w-full max-w-md mx-auto text-center">
                       <span class="text-sm font-semibold text-sky-400 tracking-wider">STEG 3 / 3</span>
                       <h3 class="text-2xl font-bold text-white mt-2">Välj din bonus</h3>
                       <p class="mt-2 text-slate-300">Som tack för ditt intresse, välj en av våra färdiga AI-agenter eller beskriv din egen drömassistent. Vi skickar en agent till din mail.</p>
                       
                       <div id="agent-selection" class="grid grid-cols-1 gap-4 mt-6 text-left">
                           <div class="agent-card" data-agent="AI Röst-receptionist">
                               <i class="ph-phone-call text-3xl text-sky-300 mb-2"></i>
                               <h4 class="font-bold text-white">AI-driven Röst-receptionist</h4>
                               <p class="text-xs text-slate-300 mt-1">Svarar på samtal dygnet runt, bokar möten och vidarekopplar intelligent – frigör tid och imponerar på kunder.</p>
                           </div>
                            <div class="agent-card" data-agent="Viral ASMR-assistent">
                               <i class="ph-speaker-high text-3xl text-sky-300 mb-2"></i>
                               <h4 class="font-bold text-white">Viral ASMR-flödesassistent</h4>
                               <p class="text-xs text-slate-300 mt-1">Skapar och schemalägger oemotståndligt ASMR-innehåll för sociala medier som maximerar engagemang och räckvidd.</p>
                           </div>
                            <div class="agent-card" data-agent="custom">
                               <i class="ph-star text-3xl text-sky-300 mb-2"></i>
                               <h4 class="font-bold text-white">Bygg din egen agent</h4>
                               <p class="text-xs text-slate-300 mt-1">Har du en unik idé? Beskriv den nedan så bygger vi ett konceptförslag åt dig.</p>
                           </div>
                       </div>
                       
                       <div id="custom-agent-wrapper" class="mt-4" style="display: none; height: 0; opacity: 0;">
                            <textarea id="customAgentRequest" name="customAgent" rows="4" class="form-input" placeholder="Beskriv din drömagent här..."></textarea>
                       </div>

                       <div class="mt-6">
                           <button type="button" id="getAgentButton" class="btn-base btn-cta-revised w-full" disabled>Välj en agent för att slutföra</button>
                       </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ======================= STEG 4: TACK ======================= -->
        <section id="step-4" style="position: absolute; left: -9999px; width: 100%;">
            <div class="min-h-screen flex items-center justify-center relative py-20 lg:py-16 overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-full z-0">
                    <video class="absolute top-1/2 left-1/2 min-w-full min-h-full w-auto h-auto object-cover transform -translate-x-1/2 -translate-y-1/2" src="https://firebasestorage.googleapis.com/v0/b/nordsym-funnel.firebasestorage.app/o/Ecosystem_Visualization.mp4?alt=media&token=a83a0050-137a-4228-a400-349071a9388c" autoplay muted loop playsinline></video>
                </div>
                <div class="absolute top-0 left-0 w-full h-full bg-slate-900/60 z-10"></div>
                
                <div class="container mx-auto px-6 text-center w-full relative z-20">
                    <div class="max-w-2xl mx-auto">
                        <i class="ph-paper-plane-tilt text-6xl text-sky-300"></i>
                        <h3 class="text-3xl font-bold text-white mt-6">Allt är klart!</h3>
                        <p class="mt-3 text-lg text-slate-300">Tack för ditt intresse! Vi har tagit emot din information och din valda agent är på väg till din inkorg. Vi hör av oss snart!</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Simple Booking Modal -->
    <div id="simple-booking-modal" class="fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4 hidden">
        <div class="bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-md relative p-8">
            <button id="close-simple-modal-btn" class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors text-2xl leading-none">&times;</button>

            <!-- Form View -->
            <div id="booking-form-view">
                <h3 class="text-2xl font-bold text-white text-center mb-1">Boka Demo</h3>
                <p class="text-slate-300 text-center mb-6">Välj en tid som passar dig så återkommer vi med en bekräftelse.</p>
                <form id="bookingForm" class="space-y-4">
                     <input type="hidden" name="_subject" value="Ny demobokning!">
                     <div><input type="text" name="name" class="form-input" placeholder="Ditt namn" required></div>
                     <div><input type="email" name="email" class="form-input" placeholder="din.email@foretag.se" required></div>
                     
                     <div>
                         <label class="block text-sm font-medium text-slate-300 mb-2 text-left">Välj ett datum</label>
                         <div id="custom-calendar" class="bg-slate-800/50 rounded-lg p-4 transition-all duration-300">
                            <div class="flex justify-between items-center mb-3 px-1">
                                <button type="button" id="cal-prev" class="p-2 rounded-full hover:bg-slate-700/50 transition-colors"><i class="ph ph-caret-left text-xl text-sky-400"></i></button>
                                <h4 id="cal-month-year" class="font-bold text-white text-lg"></h4>
                                <button type="button" id="cal-next" class="p-2 rounded-full hover:bg-slate-700/50 transition-colors"><i class="ph ph-caret-right text-xl text-sky-400"></i></button>
                            </div>
                            <div class="grid grid-cols-7 gap-1 text-center text-xs text-slate-400 font-semibold mb-2">
                                <div>Mån</div><div>Tis</div><div>Ons</div><div>Tor</div><div>Fre</div><div>Lör</div><div>Sön</div>
                            </div>
                            <div id="cal-days" class="grid grid-cols-7 gap-1">
                                <!-- Dagar genereras här av JS -->
                            </div>
                        </div>
                         <input type="hidden" id="bookingDate" name="date" required>
                     </div>

                     <div>
                         <select name="time" class="form-input" required>
                            <option value="" disabled selected>Välj en tid...</option>
                            <option value="09:00 - 09:15">09:00 - 09:15</option>
                            <option value="09:30 - 09:45">09:30 - 09:45</option>
                            <option value="10:00 - 10:15" disabled>10:00 - 10:15 (Bokad)</option>
                            <option value="10:30 - 10:45">10:30 - 10:45</option>
                            <option value="11:00 - 11:15">11:00 - 11:15</option>
                            <option value="13:00 - 13:15">13:00 - 13:15</option>
                            <option value="13:30 - 13:45" disabled>13:30 - 13:45 (Bokad)</option>
                            <option value="14:00 - 14:15">14:00 - 14:15</option>
                            <option value="14:30 - 14:45">14:30 - 14:45</option>
                            <option value="15:00 - 15:15">15:00 - 15:15</option>
                         </select>
                     </div>

                     <div>
                        <textarea name="message" class="form-input" rows="3" placeholder="Lämna ett meddelande (valfritt)"></textarea>
                     </div>

                     <div class="pt-2"><button type="submit" class="btn-base btn-cta-revised w-full">Skicka bokningsförfrågan</button></div>
                </form>
            </div>

            <!-- Success View -->
            <div id="booking-success-view" class="text-center hidden">
                <i class="ph-check-circle text-6xl text-sky-300"></i>
                <h3 class="text-2xl font-bold text-white mt-4">Tack!</h3>
                <p class="mt-2 text-slate-300">Din bokningsförfrågan har skickats. Vi bekräftar tiden via mail inom kort.</p>
                <button id="close-success-btn" class="mt-6 btn-base btn-cta-revised">Stäng</button>
            </div>
        </div>
    </div>

    <footer class="bg-nord-sym-deep-space-blue/50 border-t border-sky-800/50">
        <div class="container mx-auto px-6 py-8">
            <div class="grid md:grid-cols-3 gap-8 text-sm text-center md:text-left">
                <div class="md-col-span-1 flex flex-col items-center md:items-start">
                     <a href="https://nordsym.com" target="_blank" class="inline-block mb-4">
                        <img src="https://raw.githubusercontent.com/GusHem/Logga-utan-text/refs/heads/main/Final%20logo%20no%20text.svg" alt="NordSym Logotyp" class="h-12" loading="lazy">
                    </a>
                    <p class="text-xs text-slate-400">NordSym AB | Anpassade AI-ekosystem. Skräddarsydda för att framtidssäkra er verksamhet. Stockholm. 🇸🇪</p>
                </div>
                <div>
                    <p class="font-semibold text-white mb-2">Företaget</p>
                    <a href="https://nordsym.com" target="_blank" class="footer-link block py-1">Hemsida</a>
                    <a href="https://nordsym.com/#om-oss" target="_blank" class="footer-link block py-1">Om Oss</a>
                </div>
                 <div>
                     <p class="font-semibold text-white mb-2">Följ Oss</p>
                     <div class="flex flex-col gap-2 items-center md:items-start">
                        <a href="https://www.linkedin.com/company/nordsym-ab/" target="_blank" rel="noopener noreferrer" class="footer-link block py-1">LinkedIn</a>
                        <a href="https://x.com/NordSym" target="_blank" rel="noopener noreferrer" class="footer-link block py-1">X</a>
                        <a href="https://www.instagram.com/nordsymab/" target="_blank" rel="noopener noreferrer" class="footer-link block py-1">Instagram</a>
                     </div>
                </div>
            </div>
            <div class="mt-8 border-t border-sky-800/50 pt-6 text-center text-xs text-slate-500">
                <span>© 2024 NordSym AB. Alla rättigheter förbehållna.</span>
            </div>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let userEmailForFunnel = '';

            const logoLink = document.getElementById('logoLink');
            if (logoLink) {
                logoLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.reload();
                });
            }

            // --- Video Autoplay Logic ---
            // The main intro video should start playing immediately with sound.
            // Browsers often block this, so we start it muted (to ensure autoplay) and then try to unmute.
            const introVideo = document.getElementById('intro-video');
            if (introVideo) {
                introVideo.muted = false; // Attempt to unmute. Browser might block this, but it's the best approach.
            }
            // The phone video is set to autoplay muted via HTML attributes, which is correct.
            // --- End Video Autoplay Logic ---

            gsap.from("#step-1 > div", { opacity: 0, y: 20, duration: 0.8, ease: "power3.out" });
            
            const nextStepButton = document.getElementById('nextStepButton');
            const emailInput = document.getElementById('emailInput');

            if(nextStepButton && emailInput) {
                nextStepButton.addEventListener('click', () => {
                    const userEmail = emailInput.value;
                    if (userEmail && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(userEmail)) {
                        userEmailForFunnel = userEmail;
                        transitionToLayer(document.getElementById('step-1'), document.getElementById('step-2'));
                    } else {
                        gsap.fromTo(emailInput, { x: -10 }, { x: 10, clearProps: "x", duration: 0.1, repeat: 3 });
                        emailInput.focus();
                    }
                });
            }
            
            function transitionToLayer(fromLayer, toLayer) {
                if (userEmailForFunnel) {
                    const detailsEmailInput = document.getElementById('detailsEmail');
                    if (detailsEmailInput) detailsEmailInput.value = userEmailForFunnel;
                }

                // Mute video on the layer we are leaving
                const fromVideos = fromLayer.querySelectorAll('video');
                fromVideos.forEach(video => {
                    video.muted = true;
                });

                // Unmute the main video on the layer we are entering
                const toVideo = toLayer.querySelector('.video-container video');
                if (toVideo) {
                    toVideo.muted = false;
                    toVideo.play().catch(error => console.log("Autoplay was prevented:", error));
                }


                toLayer.style.position = 'relative';
                toLayer.style.left = '0';
                toLayer.style.opacity = '0';

                gsap.to(fromLayer, { 
                    opacity: 0, 
                    duration: 0.6, 
                    ease: 'power2.in', 
                    onComplete: () => { 
                        fromLayer.style.position = 'absolute';
                        fromLayer.style.left = '-9999px';
                        window.scrollTo(0, 0); 
                        gsap.to(toLayer, { opacity: 1, duration: 0.8, ease: 'power3.out' }); 
                        gsap.from(toLayer.querySelector('.container'), { opacity: 0, y: -20, duration: 0.5, delay: 0.3, ease: 'power2.out' }); 
                    }
                });
            }

            const detailsForm = document.getElementById('detailsForm');
            if(detailsForm) {
                detailsForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const submitButton = detailsForm.querySelector('button[type="submit"]');
                    submitButton.innerHTML = `<i class="ph-circle-notch animate-spin"></i> Skickar...`;
                    submitButton.disabled = true;

                    const formData = new FormData(detailsForm);
                    fetch("https://formspree.io/f/xzzjzaze", { 
                        method: 'POST', body: formData, headers: {'Accept': 'application/json'}
                    }).then(response => {
                        if (response.ok) {
                            transitionToLayer(document.getElementById('step-2'), document.getElementById('step-3'));
                        } else { throw new Error('Form submission failed'); }
                    }).catch(error => {
                        console.error('Form error:', error);
                        submitButton.innerHTML = 'Försök igen';
                        submitButton.disabled = false;
                    });
                });
            }

            const agentCards = document.querySelectorAll('.agent-card');
            const getAgentButton = document.getElementById('getAgentButton');
            const customAgentWrapper = document.getElementById('custom-agent-wrapper');
            const customAgentRequest = document.getElementById('customAgentRequest');
            let chosenAgent = null;

            function checkAgentButtonState() {
                if (chosenAgent && chosenAgent !== 'custom') {
                    getAgentButton.disabled = false;
                    getAgentButton.textContent = `Hämta min ${chosenAgent}-agent`;
                } else if (chosenAgent === 'custom' && customAgentRequest.value.trim() !== '') {
                    getAgentButton.disabled = false;
                    getAgentButton.textContent = 'Skicka min idé & slutför';
                } else {
                    getAgentButton.disabled = true;
                    getAgentButton.textContent = 'Välj en agent för att slutföra';
                }
            }

            agentCards.forEach(card => {
                card.addEventListener('click', () => {
                    agentCards.forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    chosenAgent = card.dataset.agent;

                    if (chosenAgent === 'custom') {
                        gsap.to(customAgentWrapper, { height: 'auto', opacity: 1, duration: 0.3, onStart: () => customAgentWrapper.style.display = 'block' });
                        customAgentRequest.focus();
                    } else {
                        gsap.to(customAgentWrapper, { height: 0, opacity: 0, duration: 0.3, onComplete: () => customAgentWrapper.style.display = 'none' });
                    }
                    checkAgentButtonState();
                });
            });

            customAgentRequest.addEventListener('input', checkAgentButtonState);

            if (getAgentButton) {
                getAgentButton.addEventListener('click', () => {
                    if (getAgentButton.disabled) return;
                    
                    getAgentButton.innerHTML = `<i class="ph-circle-notch animate-spin"></i> Skickar...`;
                    getAgentButton.disabled = true;
                    
                    const agentFormData = new FormData();
                    agentFormData.append('email', userEmailForFunnel);

                    if (chosenAgent === 'custom') {
                        const customRequestText = customAgentRequest.value.trim();
                        agentFormData.append('_subject', `Egen agent-idé från ${userEmailForFunnel}`);
                        agentFormData.append('Vald Agent', 'Egen idé');
                        agentFormData.append('Agent-idé', customRequestText);
                        agentFormData.append('message', `Användaren ${userEmailForFunnel} skickade en egen agent-idé: ${customRequestText}`);
                    } else {
                        agentFormData.append('_subject', `Agent-val: ${chosenAgent}`);
                        agentFormData.append('Vald Agent', chosenAgent);
                        agentFormData.append('message', `Användaren ${userEmailForFunnel} valde agenten: ${chosenAgent}.`);
                    }

                    fetch("https://formspree.io/f/xzzjzaze", {
                        method: 'POST', body: agentFormData, headers: {'Accept': 'application/json'}
                    }).then(response => {
                        if(response.ok) {
                           transitionToLayer(document.getElementById('step-3'), document.getElementById('step-4'));
                        } else { throw new Error('Agent form submission failed'); }
                    }).catch(error => {
                        console.error('Form error:', error);
                        // Re-enable button and restore state on error
                        getAgentButton.disabled = false;
                        checkAgentButtonState();
                    });
                });
            }


            function initSliderNav() {
                const track = document.getElementById('nav-track');
                const thumb = document.getElementById('nav-thumb');
                const thumbIcon = document.getElementById('thumb-icon');
                const screenWrapper = document.getElementById('screen-wrapper');

                if (!track || !thumb || !screenWrapper) return;

                const numStops = 3;
                const iconClasses = ['ph-house', 'ph-file-text', 'ph-gear'];
                let currentIndex = 0;
                let isDragging = false;
                let startX, startLeft;
                let snapPoints = [];

                function calculateSnapPoints() {
                    snapPoints = [];
                    const trackWidth = track.clientWidth;
                    const thumbWidth = thumb.offsetWidth;
                    const usableWidth = trackWidth - thumbWidth;
                    for (let i = 0; i < numStops; i++) {
                        snapPoints.push((usableWidth / (numStops - 1)) * i);
                    }
                    gsap.to(thumb, { left: snapPoints[currentIndex], duration: 0 });
                }

                function updateUI(newIndex) {
                    if (newIndex < 0 || newIndex >= numStops) return;
                    currentIndex = newIndex;
                    screenWrapper.style.transform = `translateX(-${newIndex * (100/3)}%)`;
                    thumbIcon.className = `${iconClasses[currentIndex]} text-lg`;
                    gsap.to(thumb, { left: snapPoints[currentIndex], duration: 0.3, ease: 'power2.out' });
                }

                function startDrag(e) {
                    e.preventDefault(); isDragging = true;
                    thumb.classList.add('grabbing');
                    startX = (e.touches ? e.touches[0].clientX : e.clientX);
                    startLeft = thumb.offsetLeft;
                    document.addEventListener('mousemove', onDrag);
                    document.addEventListener('touchmove', onDrag, { passive: false });
                    document.addEventListener('mouseup', endDrag);
                    document.addEventListener('touchend', endDrag);
                }

                function onDrag(e) {
                    if (!isDragging) return;
                    e.preventDefault();
                    const currentX = (e.touches ? e.touches[0].clientX : e.clientX);
                    const diffX = currentX - startX;
                    let newLeft = startLeft + diffX;
                    newLeft = Math.max(snapPoints[0], Math.min(newLeft, snapPoints[numStops - 1]));
                    thumb.style.left = newLeft + 'px';
                }

                function endDrag() {
                    if (!isDragging) return;
                    isDragging = false; thumb.classList.remove('grabbing');
                    document.removeEventListener('mousemove', onDrag);
                    document.removeEventListener('touchmove', onDrag);
                    document.removeEventListener('mouseup', endDrag);
                    document.removeEventListener('touchend', endDrag);
                    const currentLeft = thumb.offsetLeft;
                    let closestIndex = snapPoints.reduce((prev, curr, index) => 
                        (Math.abs(curr - currentLeft) < Math.abs(snapPoints[prev] - currentLeft) ? index : prev), 0);
                    updateUI(closestIndex);
                }
                
                calculateSnapPoints();
                updateUI(0);
                thumb.addEventListener('mousedown', startDrag);
                thumb.addEventListener('touchstart', startDrag, { passive: false });
                window.addEventListener('resize', calculateSnapPoints);
            }
            initSliderNav();
            
            const appChatMessages = document.getElementById('app-chat-messages');
            const appChatForm = document.getElementById('app-chat-form');
            const appChatInput = document.getElementById('app-chat-input');
            let chatStep = 0;

            function addAppMessage(sender, text) {
                const messageEl = document.createElement('div');
                messageEl.classList.add('app-chat-message', `app-message-${sender}`);
                messageEl.innerHTML = (sender === 'klara' ? `<img src="https://raw.githubusercontent.com/GusHem/NordSym-Logga/refs/heads/main/closupklara.svg" alt="Klara" class="app-chat-avatar">` : '') + `<div class="app-chat-bubble">${text}</div>`;
                appChatMessages.appendChild(messageEl);
                appChatMessages.scrollTop = appChatMessages.scrollHeight;
            }

            appChatForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const userText = appChatInput.value.trim();
                if (!userText) return;

                if (appChatMessages.classList.contains('is-idle')) {
                    appChatMessages.innerHTML = ''; 
                    appChatMessages.classList.remove('is-idle');
                }
                addAppMessage('user', userText);
                appChatInput.value = '';
                
                setTimeout(() => {
                    const responses = [
                        'Absolut! Hur många gäster beräknar du med?',
                        'Utmärkt! Vilket datum och tid hade du tänkt dig?',
                        'Noterat! Har du några speciella önskemål kring menyn?',
                        'Det låter fantastiskt! En av våra projektledare kontaktar dig inom kort med en offert. Tack!'
                    ];
                    addAppMessage('klara', responses[chatStep % responses.length]);
                    chatStep++;
                }, 1200);
            });
            
            // --- Custom Calendar Logic ---
            function initCustomCalendar() {
                const monthYearEl = document.getElementById('cal-month-year');
                const daysEl = document.getElementById('cal-days');
                const prevBtn = document.getElementById('cal-prev');
                const nextBtn = document.getElementById('cal-next');
                const hiddenDateInput = document.getElementById('bookingDate');

                if (!monthYearEl || !daysEl || !prevBtn || !nextBtn || !hiddenDateInput) {
                    console.error('Calendar elements not found');
                    return;
                }

                let currentDate = new Date();
                currentDate.setDate(1);

                const renderCalendar = () => {
                    const today = new Date();
                    const month = currentDate.getMonth();
                    const year = currentDate.getFullYear();

                    monthYearEl.textContent = `${new Intl.DateTimeFormat('sv-SE', { month: 'long', year: 'numeric' }).format(currentDate)}`;
                    daysEl.innerHTML = '';

                    const firstDayOfMonth = new Date(year, month, 1).getDay();
                    const lastDateOfMonth = new Date(year, month + 1, 0).getDate();
                    
                    const dayOffset = (firstDayOfMonth === 0) ? 6 : firstDayOfMonth - 1;

                    for (let i = 0; i < dayOffset; i++) {
                        daysEl.innerHTML += `<div class="cal-day empty"></div>`;
                    }

                    for (let i = 1; i <= lastDateOfMonth; i++) {
                        const dayDate = new Date(year, month, i);
                        const dayEl = document.createElement('div');
                        dayEl.classList.add('cal-day');
                        dayEl.textContent = i;
                        dayEl.dataset.date = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;

                        if (dayDate < new Date(today.getFullYear(), today.getMonth(), today.getDate())) {
                            dayEl.classList.add('disabled');
                        }

                        if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                            dayEl.classList.add('today');
                        }
                        
                        if (dayEl.dataset.date === hiddenDateInput.value) {
                             dayEl.classList.add('selected');
                        }

                        daysEl.appendChild(dayEl);
                    }
                };
                
                daysEl.addEventListener('click', (e) => {
                    const target = e.target.closest('.cal-day');
                    if (target && !target.classList.contains('disabled') && !target.classList.contains('empty')) {
                        document.querySelectorAll('#cal-days .cal-day.selected').forEach(el => el.classList.remove('selected'));
                        target.classList.add('selected');
                        hiddenDateInput.value = target.dataset.date;
                    }
                });

                prevBtn.addEventListener('click', () => {
                    currentDate.setMonth(currentDate.getMonth() - 1);
                    renderCalendar();
                });

                nextBtn.addEventListener('click', () => {
                    currentDate.setMonth(currentDate.getMonth() + 1);
                    renderCalendar();
                });

                renderCalendar();
            }

            // --- Simple Booking Modal Logic ---
            const simpleBookingModal = document.getElementById('simple-booking-modal');
            const demoButton = document.querySelector('header .btn-cta-revised');

            if (simpleBookingModal && demoButton) {
                const modalContent = simpleBookingModal.querySelector('.bg-slate-900');
                const closeSimpleModalBtn = document.getElementById('close-simple-modal-btn');
                const bookingForm = document.getElementById('bookingForm');
                const formView = document.getElementById('booking-form-view');
                const successView = document.getElementById('booking-success-view');
                const closeSuccessBtn = document.getElementById('close-success-btn');

                initCustomCalendar();

                const openModal = () => {
                    simpleBookingModal.classList.remove('hidden');
                    gsap.fromTo(modalContent, {opacity: 0, scale: 0.95}, {opacity: 1, scale: 1, duration: 0.3, ease: 'power2.out'});
                };

                const closeModal = () => {
                    gsap.to(modalContent, {opacity: 0, scale: 0.95, duration: 0.3, ease: 'power2.in', onComplete: () => {
                       simpleBookingModal.classList.add('hidden');
                       formView.classList.remove('hidden');
                       successView.classList.add('hidden');
                       bookingForm.reset();
                   }});
                };

                demoButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    openModal();
                });

                closeSimpleModalBtn.addEventListener('click', closeModal);
                closeSuccessBtn.addEventListener('click', closeModal);

                document.addEventListener('keydown', (e) => {
                    if (e.key === "Escape" && !simpleBookingModal.classList.contains('hidden')) {
                        closeModal();
                    }
                });

                simpleBookingModal.addEventListener('click', (e) => {
                    if (e.target === simpleBookingModal) {
                        closeModal();
                    }
                });

                bookingForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const submitButton = bookingForm.querySelector('button[type="submit"]');
                    submitButton.innerHTML = `<i class="ph-circle-notch animate-spin"></i> Skickar...`;
                    submitButton.disabled = true;

                    const formData = new FormData(bookingForm);
                    fetch("https://formspree.io/f/xqayadak", {
                        method: 'POST', body: formData, headers: {'Accept': 'application/json'}
                    })
                    .then(response => {
                        if (response.ok) {
                            formView.classList.add('hidden');
                            successView.classList.remove('hidden');
                        } else {
                            throw new Error('Form submission failed');
                        }
                    })
                    .catch(error => {
                        console.error('Form error:', error);
                        // Optionally show an error message to the user here
                    })
                    .finally(() => {
                        submitButton.innerHTML = 'Skicka bokningsförfrågan';
                        submitButton.disabled = false;
                    });
                });
            }

        });
    </script>
</body>
</html>





